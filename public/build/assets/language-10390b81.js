Vue.component("confirmation-dialog",require("../components/ConfirmationDialog").default);new Vue({el:"#app",data:{languages:data.languages,selectedLanguage:data.selectedLanguage,searchPhrase:"",selectedKey:null,translations:[],filteredTranslations:[],newKeyErrorMsg:"",newKeyValueErrorMsg:"",confirmDialog:!1,addNewKey:!1,newKey:"",newKeyValue:""},methods:{highlight(e){if(e)return e.replace(/:{1}[\w-]+/gi,function(t){return"<mark>"+t+"</mark>"})},changeLanguage(e){this.selectedLanguage=e,this.filteredTranslations=this.translations[e],this.searchPhrase="",this.selectedKey=null,this.addNewKey=""},save(){let e={translations:this.translations};axios.put(data.routes.update,e).then(t=>{flashBox(t.data.type,t.data.message)})},saveNewKey:function(){if(!this.newKey.length){this.newKeyErrorMsg=data.newKeyError;return}if(this.newKeyErrorMsg="",!this.newKeyValue.length){this.newKeyValueErrorMsg=data.newKeyValueError;return}this.newKeyValueErrorMsg="",_.forEach(this.languages,e=>{this.translations[e][this.newKey]=this.newKeyValue}),this.save()},getTranslations(){axios.get(data.routes.getTranslations).then(e=>{this.translations=e.data,this.filteredTranslations=this.translations[this.selectedLanguage]})},changeTranslations(e,t){this.translations[this.selectedLanguage][e]=t.target.value,this.filteredTranslations[e]=t.target.value},searchTranslations(){let e={};this.searchPhrase.length>0?(_.forEach(this.filteredTranslations,(t,s)=>{s&&s.toString().trim().toLowerCase().includes(this.searchPhrase.trim().toLowerCase())&&(e[s]=this.filteredTranslations[s])}),this.filteredTranslations=e):this.filteredTranslations=this.translations[this.selectedLanguage]},sync(){axios.put(data.routes.sync).then(e=>{flashBox(e.data.type,e.data.message),this.translations=e.data.translations,this.filteredTranslations=this.translations[this.selectedLanguage]})},add(){this.addNewKey=!0},remove(){this.confirmDialog=!0},confirmDelete(){this.confirmDialog=!1,_.forEach(this.languages,e=>{this.translations[e]=_.omit(this.translations[e],[this.selectedKey])}),this.filteredTranslations=this.translations[this.selectedLanguage],this.selectedKey=null,this.save()},cancelDelete(){this.confirmDialog=!1}},mounted(){this.getTranslations()},filters:{uppercase:function(e){return e?(e=e.toString(),e.toUpperCase()):""}}});
